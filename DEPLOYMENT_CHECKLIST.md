# ✅ StudyMate API 배포 체크리스트

## 📝 배포 전 체크리스트

### 1. 코드 준비
- [ ] 모든 변경사항이 커밋되었는가?
- [ ] 테스트가 모두 통과하는가?
- [ ] 코드 리뷰가 완료되었는가?
- [ ] requirements.txt가 최신 상태인가?
- [ ] .env.example이 업데이트되었는가?

### 2. 보안 확인
- [ ] 민감한 정보가 코드에 포함되지 않았는가?
- [ ] .gitignore가 제대로 설정되었는가?
- [ ] 환경 변수가 모두 설정되었는가?
- [ ] DEBUG=False로 설정되었는가?
- [ ] ALLOWED_HOSTS가 올바르게 설정되었는가?

### 3. 데이터베이스
- [ ] 마이그레이션 파일이 준비되었는가?
- [ ] 데이터베이스 백업이 있는가?
- [ ] 인덱스가 최적화되었는가?

### 4. 의존성
- [ ] Python 패키지가 모두 설치 가능한가?
- [ ] 버전 충돌이 없는가?
- [ ] 프로덕션 불필요 패키지가 제거되었는가?

---

## 🚀 배포 중 체크리스트

### 1. GitHub Actions (자동 배포)
- [ ] main 브랜치에 푸시
- [ ] GitHub Actions 페이지에서 진행 상황 확인
- [ ] 테스트 단계 통과 확인
- [ ] 배포 단계 시작 확인

### 2. 수동 배포
```bash
# EC2 접속
ssh -i your-key.pem ec2-user@your-ec2-ip

# 배포 스크립트 실행
cd ~/apps/StudyMate-API
./scripts/deploy.sh
```

### 3. 배포 진행 확인
- [ ] Git pull 성공
- [ ] 의존성 설치 완료
- [ ] 마이그레이션 실행 완료
- [ ] 정적 파일 수집 완료
- [ ] 새 인스턴스 시작 확인
- [ ] 헬스 체크 통과

---

## ✅ 배포 후 체크리스트

### 1. 서비스 확인
- [ ] 웹사이트가 정상적으로 접속되는가?
- [ ] API 엔드포인트가 응답하는가?
- [ ] 로그인이 정상 작동하는가?
- [ ] 주요 기능이 작동하는가?

### 2. 모니터링
```bash
# tmux 세션 확인
tmux ls

# 프로세스 확인
ps aux | grep gunicorn

# 로그 확인
tail -f ~/apps/logs/error.log
tail -f ~/apps/logs/access.log

# 시스템 리소스 확인
htop
df -h
free -m
```

### 3. 성능 확인
- [ ] 응답 시간이 정상인가?
- [ ] 메모리 사용량이 안정적인가?
- [ ] CPU 사용률이 정상인가?
- [ ] 디스크 공간이 충분한가?

### 4. 보안 확인
- [ ] HTTPS가 작동하는가? (프로덕션)
- [ ] 불필요한 포트가 닫혀있는가?
- [ ] 에러 메시지가 노출되지 않는가?

---

## 🔴 롤백 체크리스트

### 문제 발생 시
1. **즉시 롤백**
   ```bash
   cd ~/apps/StudyMate-API
   ./scripts/rollback.sh
   ```

2. **롤백 확인**
   - [ ] 이전 버전으로 전환되었는가?
   - [ ] 서비스가 정상 작동하는가?
   - [ ] 에러가 해결되었는가?

3. **원인 분석**
   - [ ] 에러 로그 확인
   - [ ] 최근 변경사항 검토
   - [ ] 테스트 케이스 추가

---

## 📊 배포 로그

### 배포 기록 양식
```markdown
## 2024-12-22 배포
- **버전**: v1.0.0
- **배포자**: @username
- **변경사항**: 
  - 기능 추가
  - 버그 수정
- **상태**: ✅ 성공
- **메모**: 특이사항 없음
```

---

## 🛠 트러블슈팅 가이드

### 자주 발생하는 문제

| 문제 | 원인 | 해결 |
|------|------|------|
| 502 Bad Gateway | Gunicorn 미실행 | `./scripts/deploy.sh` 재실행 |
| 마이그레이션 실패 | DB 연결 문제 | DB 상태 확인, .env 확인 |
| 정적 파일 404 | collectstatic 미실행 | `python manage.py collectstatic` |
| 메모리 부족 | 워커 과다 | 워커 수 줄이기 (2개) |
| 포트 사용 중 | 이전 프로세스 | `tmux kill-session -t studymate_8000` |

---

## 📞 긴급 연락처

- **DevOps 담당**: devops@studymate.com
- **시스템 관리자**: admin@studymate.com
- **AWS Support**: AWS Console → Support Center

---

## 📋 주간 점검 사항

### 매주 월요일
- [ ] 로그 파일 정리
- [ ] 백업 파일 확인
- [ ] 시스템 업데이트 확인
- [ ] 보안 패치 확인
- [ ] 성능 메트릭 검토

### 매월 1일
- [ ] SSL 인증서 만료일 확인
- [ ] 도메인 만료일 확인
- [ ] AWS 비용 검토
- [ ] 전체 백업 수행

---

**마지막 업데이트**: 2024년 12월
**버전**: 1.0.0